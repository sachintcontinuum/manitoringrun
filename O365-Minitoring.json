{
	"info": {
		"_postman_id": "7b9a07fb-c628-44f7-87f2-85860bf8a54c",
		"name": "O365-Minitoring",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "TP-GET-ACCESS-TOKEN",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "1576227e-e463-4bfc-8719-895b4970f1d2",
						"exec": [
							"\r",
							"\r",
							"\r",
							"tests[\"TP-GET-ACCESS-TOKEN - Status code is 200\"] = responseCode.code === 200\r",
							"\r",
							"var Ajv = require('ajv'),\r",
							"    ajv = new Ajv({logger: console}),\r",
							"    schema = {\r",
							"    \"required\": [\r",
							"        \"access_token\",\r",
							"        \"token_type\",\r",
							"        \"expires_in\",\r",
							"        \"refresh_token\",\r",
							"        \"id_token\",\r",
							"        \"scopes\"\r",
							"    ],\r",
							"    \"properties\": {\r",
							"        \"access_token\": {\r",
							"            \"$id\": \"#/properties/access_token\",\r",
							"            \"type\": \"string\"\r",
							"        },\r",
							"        \"token_type\": {\r",
							"            \"$id\": \"#/properties/token_type\",\r",
							"            \"type\": \"string\"\r",
							"        },\r",
							"        \"expires_in\": {\r",
							"            \"$id\": \"#/properties/expires_in\",\r",
							"            \"type\": \"integer\"\r",
							"        },\r",
							"        \"refresh_token\": {\r",
							"            \"$id\": \"#/properties/refresh_token\",\r",
							"            \"type\": \"string\"\r",
							"        },\r",
							"        \"id_token\": {\r",
							"            \"$id\": \"#/properties/id_token\",\r",
							"            \"type\": \"string\"\r",
							"        },\r",
							"        \"scopes\": {\r",
							"            \"$id\": \"#/properties/scopes\",\r",
							"            \"type\": \"string\"\r",
							"        }\r",
							"    }\r",
							"};\r",
							" \r",
							"pm.test('TP-GET-ACCESS-TOKEN -Schema is valid', function() {\r",
							"    pm.expect(ajv.validate(schema, pm.response.json()), JSON.stringify(ajv.errors)).to.be.true;\r",
							"});\r",
							"\r",
							"var jsonData = JSON.parse(responseBody);\r",
							"accesstokenvalue = jsonData.access_token\r",
							"\r",
							"pm.environment.set(\"msaccesstoken\", accesstokenvalue);\r",
							"\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "http://internal-third-party-integration-elb-1263876329.ap-south-1.elb.amazonaws.com/third-party-integration/v1/partners/50016367/clients/50110212/sites/50110212/oauth/O365/token",
					"protocol": "http",
					"host": [
						"internal-third-party-integration-elb-1263876329",
						"ap-south-1",
						"elb",
						"amazonaws",
						"com"
					],
					"path": [
						"third-party-integration",
						"v1",
						"partners",
						"50016367",
						"clients",
						"50110212",
						"sites",
						"50110212",
						"oauth",
						"O365",
						"token"
					]
				}
			},
			"response": []
		},
		{
			"name": "MS-GET-RISK-DETECTION",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "f0b8a219-c6d5-4207-8b3e-d3c5215dbcd8",
						"exec": [
							"tests[\"MS-GET-RISKS - Status code is 200\"] = responseCode.code === 200\r",
							"\r",
							"var Ajv = require('ajv'),\r",
							"    ajv = new Ajv({logger: console}),\r",
							"    schema = {\r",
							"    \"required\": [\r",
							"        \"@odata.context\",\r",
							"        \"@odata.nextLink\",\r",
							"        \"value\"\r",
							"    ],\r",
							"    \"properties\": {\r",
							"        \"@odata.context\": {\r",
							"            \"$id\": \"#/properties/@odata.context\",\r",
							"            \"type\": \"string\"\r",
							"        },\r",
							"        \"@odata.nextLink\": {\r",
							"            \"$id\": \"#/properties/@odata.nextLink\",\r",
							"            \"type\": \"string\"\r",
							"        },\r",
							"        \"value\": {\r",
							"            \"items\": {\r",
							"                \"required\": [\r",
							"                    \"id\",\r",
							"                    \"requestId\",\r",
							"                    \"correlationId\",\r",
							"                    \"riskType\",\r",
							"                    \"riskEventType\",\r",
							"                    \"riskState\",\r",
							"                    \"riskLevel\",\r",
							"                    \"riskDetail\",\r",
							"                    \"source\",\r",
							"                    \"detectionTimingType\",\r",
							"                    \"activity\",\r",
							"                    \"tokenIssuerType\",\r",
							"                    \"ipAddress\",\r",
							"                    \"activityDateTime\",\r",
							"                    \"detectedDateTime\",\r",
							"                    \"lastUpdatedDateTime\",\r",
							"                    \"userId\",\r",
							"                    \"userDisplayName\",\r",
							"                    \"userPrincipalName\",\r",
							"                    \"additionalInfo\",\r",
							"                    \"location\"\r",
							"                ],\r",
							"                \"properties\": {\r",
							"                    \"id\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/id\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"requestId\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/requestId\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"correlationId\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/correlationId\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"riskType\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/riskType\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"riskEventType\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/riskEventType\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"riskState\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/riskState\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"riskLevel\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/riskLevel\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"riskDetail\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/riskDetail\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"source\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/source\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"detectionTimingType\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/detectionTimingType\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"activity\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/activity\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"tokenIssuerType\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/tokenIssuerType\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"ipAddress\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/ipAddress\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"activityDateTime\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/activityDateTime\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"detectedDateTime\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/detectedDateTime\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"lastUpdatedDateTime\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/lastUpdatedDateTime\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"userId\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/userId\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"userDisplayName\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/userDisplayName\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"userPrincipalName\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/userPrincipalName\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"additionalInfo\": {\r",
							"                        \"$id\": \"#/properties/value/items/properties/additionalInfo\",\r",
							"                        \"type\": \"string\"\r",
							"                    },\r",
							"                    \"location\": {\r",
							"                        \"required\": [\r",
							"                            \"city\",\r",
							"                            \"state\",\r",
							"                            \"countryOrRegion\",\r",
							"                            \"geoCoordinates\"\r",
							"                        ],\r",
							"                        \"properties\": {\r",
							"                            \"city\": {\r",
							"                                \"$id\": \"#/properties/value/items/properties/location/properties/city\",\r",
							"                                \"type\": [ \"string\", \"null\" ]\r",
							"                            },\r",
							"                            \"state\": {\r",
							"                                \"$id\": \"#/properties/value/items/properties/location/properties/state\",\r",
							"                               \"type\": [ \"string\", \"null\" ]\r",
							"                            },\r",
							"                            \"countryOrRegion\": {\r",
							"                                \"$id\": \"#/properties/value/items/properties/location/properties/countryOrRegion\",\r",
							"                                \"type\": \"string\"\r",
							"                            },\r",
							"                            \"geoCoordinates\": {\r",
							"                                \"required\": [\r",
							"                                    \"latitude\",\r",
							"                                    \"longitude\"\r",
							"                                ],\r",
							"                                \"properties\": {\r",
							"                                    \"latitude\": {\r",
							"                                        \"$id\": \"#/properties/value/items/properties/location/properties/geoCoordinates/properties/latitude\",\r",
							"                                        \"type\": \"number\"\r",
							"                                    },\r",
							"                                    \"longitude\": {\r",
							"                                        \"$id\": \"#/properties/value/items/properties/location/properties/geoCoordinates/properties/longitude\",\r",
							"                                        \"type\": \"number\"\r",
							"                                    }\r",
							"                                },\r",
							"                                \"$id\": \"#/properties/value/items/properties/location/properties/geoCoordinates\",\r",
							"                                \"type\": \"object\"\r",
							"                            }\r",
							"                        },\r",
							"                        \"$id\": \"#/properties/value/items/properties/location\",\r",
							"                        \"type\": \"object\"\r",
							"                    }\r",
							"                },\r",
							"                \"$id\": \"#/properties/value/items\",\r",
							"                \"type\": \"object\"\r",
							"            },\r",
							"            \"$id\": \"#/properties/value\",\r",
							"            \"type\": \"array\"\r",
							"        }\r",
							"    },\r",
							"    \"$id\": \"http://example.org/root.json#\",\r",
							"    \"type\": \"object\",\r",
							"    \"definitions\": {},\r",
							"    \"$schema\": \"http://json-schema.org/draft-07/schema#\"\r",
							"};\r",
							" \r",
							"pm.test('MS-GET-RISKS - Schema is valid', function() {\r",
							"    pm.expect(ajv.validate(schema, pm.response.json()), JSON.stringify(ajv.errors)).to.be.true;\r",
							"});\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "bearer {{msaccesstoken}}",
						"type": "text"
					}
				],
				"url": {
					"raw": "https://graph.microsoft.com/beta/riskDetections",
					"protocol": "https",
					"host": [
						"graph",
						"microsoft",
						"com"
					],
					"path": [
						"beta",
						"riskDetections"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "2b38966e-cc07-497b-b04c-58ce40df0c06",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "eda51068-a56e-4a6a-a45b-c5d399030ec6",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}